<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المصادر العلمية | Findemy.dz</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .subscription-section {
            padding: 80px 0;
        }
        
        .resource-card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            margin-bottom: 20px;
            height: 100%;
        }
        
        .resource-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(139, 26, 59, 0.15);
        }
        
        .free-badge {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .premium-badge {
            background: linear-gradient(135deg, var(--warning-color), #ff8c00);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .resource-link {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
        }
        
        .resource-link:hover {
            color: var(--light-accent);
            transform: translateX(-5px);
        }
        
        .category-badge {
            background-color: var(--primary-color);
            color: white;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 20px;
            display: inline-block;
        }
        
        .subscription-plans {
            background: linear-gradient(135deg, var(--primary-color), var(--light-accent));
            color: white;
            padding: 60px 0;
            border-radius: 15px;
            margin: 40px 0;
        }
        
        .plan-card {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }
        
        .plan-card:hover {
            transform: translateY(-10px);
            background: rgba(255,255,255,0.15);
        }
        
        .plan-price {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }
        
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }

        .sources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .quick-links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .quick-link-item {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
            text-align: center;
        }

        .quick-link-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- القائمة الجانبية -->
<nav class="sidebar">
    <div class="sidebar-header">
        <h2><i class="fas fa-graduation-cap"></i> Findemy.dz</h2>
    </div>
    <ul class="sidebar-menu">
        <li><a href="{{ url_for('home') }}"><i class="fas fa-home"></i> الرئيسية</a></li>
        <li><a href="{{ url_for('resources') }}"><i class="fas fa-book"></i> الموارد</a></li>
        <li><a href="{{ url_for('sources') }}"><i class="fas fa-database"></i> المصادر العلمية</a></li>
        <li><a href="{{ url_for('search') }}"><i class="fas fa-search"></i> البحث المتقدم</a></li>
        <li><a href="{{ url_for('books') }}"><i class="fas fa-exchange-alt"></i> الكتب المستعملة</a></li>
        <li><a href="{{ url_for('about') }}"><i class="fas fa-info-circle"></i> عن المنصة</a></li>
        
        <!-- رابط لوحة التحكم يظهر فقط للأدمن -->
        {% if session.get('user_role') == 'admin' %}
        <li><a href="{{ url_for('admin_dashboard') }}"><i class="fas fa-tachometer-alt"></i> لوحة التحكم</a></li>
        {% endif %}
        
        {% if user_logged_in %}
            <li><a href="{{ url_for('logout') }}"><i class="fas fa-sign-out-alt"></i> تسجيل الخروج</a></li>
        {% else %}
            <li><a href="{{ url_for('login') }}"><i class="fas fa-sign-in-alt"></i> تسجيل الدخول</a></li>
            <li><a href="{{ url_for('register') }}"><i class="fas fa-user-plus"></i> إنشاء حساب</a></li>
        {% endif %}
    </ul>
</nav>

    <!-- زر القائمة -->
    <button class="menu-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- المحتوى الرئيسي -->
    <div class="main-content">
        <!-- قسم البطل -->
        <section class="hero-section">
            <div class="hero-overlay">
                <div class="hero-container">
                    <h1 class="hero-title">المصادر العلمية</h1>
                    <p class="hero-description">
                        استفد من مجموعة واسعة من المصادر العلمية المجانية والمميزة
                    </p>
                </div>
            </div>
        </section>

        <!-- قسم قواعد البيانات -->
        <section class="py-5 bg-light">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">قواعد البيانات الأكاديمية المتاحة</h2>
                    <p class="section-subtitle">اكتشف مجموعة متنوعة من المصادر العلمية المجانية والمميزة</p>
                </div>

                <!-- قواعد البيانات مفتوحة المصدر -->
                <div class="mb-5">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3 class="text-primary">مفتوحة المصدر <span class="free-badge">مجانية</span></h3>
                    </div>
                    
                    <div id="openSources" class="sources-grid">
                        <!-- سيتم ملؤها بالجافاسكريبت -->
                    </div>
                </div>

                <!-- قواعد البيانات مغلقة المصدر -->
                <div class="mb-5">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3 class="text-primary">مغلقة المصدر <span class="premium-badge">مميزة</span></h3>
                        <div class="alert alert-warning mb-0">
                            <i class="fas fa-info-circle me-2"></i>
                            تتطلب اشتراك لتفعيلها  
                        </div>
                    </div>
                    
                    <div id="closedSources" class="sources-grid">
                        <!-- سيتم ملؤها بالجافاسكريبت -->
                    </div>
                </div>
            </div>
        </section>

        <!-- مصادر أكاديمية إضافية -->
        <section class="py-5">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">مصادر أكاديمية إضافية</h2>
                </div>

                <!-- محركات البحث -->
                <div class="mb-5">
                    <span class="category-badge">محركات البحث</span>
                    <div id="searchEngines" class="quick-links-grid">
                        <!-- سيتم ملؤها بالجافاسكريبت -->
                    </div>
                </div>

                <!-- Open Access -->
                <div class="mb-5">
                    <span class="category-badge">Open Access</span>
                    <div id="openAccess" class="quick-links-grid">
                        <!-- سيتم ملؤها بالجافاسكريبت -->
                    </div>
                </div>

                <!-- المكتبات الرقمية -->
                <div class="mb-5">
                    <span class="category-badge">المكتبات الرقمية</span>
                    <div id="digitalLibraries" class="quick-links-grid">
                        <!-- سيتم ملؤها بالجافاسكريبت -->
                    </div>
                </div>

                <!-- المجلات العلمية -->
                <div class="mb-5">
                    <span class="category-badge">المجلات العلمية</span>
                    <div id="scientificJournals" class="quick-links-grid">
                        <!-- سيتم ملؤها بالجافاسكريبت -->
                    </div>
                </div>
            </div>
        </section>

        <!-- رسالة التحميل -->
        <div id="loadingMessage" style="text-align: center; padding: 40px; color: var(--secondary-color);">
            <i class="fas fa-spinner fa-spin fa-2x"></i>
            <p style="margin-top: 15px;">جاري تحميل المصادر العلمية...</p>
        </div>

        <!-- الفوتر -->
        <footer class="footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-brand">
                        <img src="{{ url_for('static', filename='img/LOGO B.png') }}" alt="Findemy.dz" class="logo-img">
                        <p class="footer-description">
                            منصة تجمع كل ما يحتاجه الطالب والباحث في مكان واحد
                        </p>
                    </div>
                    <div class="footer-links">
                        <div class="footer-column">
                            <h4>روابط سريعة</h4>
                            <a href="https://www.researchgate.net/login" target="_blank"><i class="fas fa-external-link-alt"></i> ResearchGate</a>
                            <a href="https://scholar.google.com/" target="_blank"><i class="fas fa-external-link-alt"></i> Google Scholar</a>
                            <a href="https://www.academia.edu/" target="_blank"><i class="fas fa-external-link-alt"></i> Academia</a>
                            <a href="https://www.sndl.cerist.dz/" target="_blank"><i class="fas fa-external-link-alt"></i> SNDL</a>
                            <a href="https://endnote.com/" target="_blank"><i class="fas fa-external-link-alt"></i> EndNote</a>
                        </div>
                        <div class="footer-column">
                            <h4>تواصل معنا</h4>
                            <p><i class="fas fa-envelope"></i> contact@findemy.dz</p>
                            <p><i class="fas fa-phone"></i> +213 XX XX XX XX</p>
                        </div>
                        <div class="footer-column">
                            <h4>عن المنصة</h4>
                            <a href="{{ url_for('about') }}"><i class="fas fa-info-circle"></i> عن المنصة</a>
                            <a href="{{ url_for('register') }}"><i class="fas fa-user-plus"></i> إنشاء حساب</a>
                            <a href="{{ url_for('login') }}"><i class="fas fa-sign-in-alt"></i> تسجيل الدخول</a>
                        </div>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p>© 2025 Findemy.dz – جميع الحقوق محفوظة</p>
                    <p>منصة تقدم خدمات المعلومات</p>
                </div>
            </div>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script>
        let scientificSources = [];

        // عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            loadScientificSources();
        });

        // تحميل البيانات من API
        async function loadScientificSources() {
            const loadingMessage = document.getElementById('loadingMessage');
            
            try {
                loadingMessage.style.display = 'block';
                
                const response = await fetch('/api/scientific-sources');
                
                if (!response.ok) {
                    throw new Error('فشل في جلب البيانات من الخادم');
                }
                
                scientificSources = await response.json();
                
                if (scientificSources.length === 0) {
                    showNoSources();
                    return;
                }
                
                displayScientificSources();
                
            } catch (error) {
                console.error('Error:', error);
                showErrorMessage('حدث خطأ في تحميل المصادر العلمية. يرجى المحاولة مرة أخرى.');
            } finally {
                loadingMessage.style.display = 'none';
            }
        }

        // عرض المصادر العلمية
        function displayScientificSources() {
            displayOpenSources();
            displayClosedSources();
            displayAdditionalSources();
        }

        // عرض المصادر مفتوحة المصدر
        function displayOpenSources() {
            const openSourcesContainer = document.getElementById('openSources');
            const openSources = scientificSources.filter(source => source.type === 'مفتوحة');
            
            openSourcesContainer.innerHTML = '';
            
            openSources.forEach(source => {
                const sourceCard = createSourceCard(source);
                openSourcesContainer.appendChild(sourceCard);
            });
        }

        // عرض المصادر مغلقة المصدر
        function displayClosedSources() {
            const closedSourcesContainer = document.getElementById('closedSources');
            const closedSources = scientificSources.filter(source => source.type === 'مغلقة');
            
            closedSourcesContainer.innerHTML = '';
            
            closedSources.forEach(source => {
                const sourceCard = createSourceCard(source);
                closedSourcesContainer.appendChild(sourceCard);
            });
        }

        // عرض المصادر الإضافية
        function displayAdditionalSources() {
            const additionalSources = scientificSources.filter(source => source.type === 'إضافية');
            
            // محركات البحث
            const searchEngines = additionalSources.filter(source => 
                source.name.includes('Scholar') || source.name.includes('Seek') || 
                source.name.includes('PMC') || source.name.includes('Semantic')
            );
            displayQuickLinks('searchEngines', searchEngines, 'fas fa-search');
            
            // Open Access
            const openAccess = additionalSources.filter(source => 
                source.name.includes('AOSIS') || source.name.includes('SCIRP') || 
                source.name.includes('Academic Journals') || source.name.includes('CORE')
            );
            displayQuickLinks('openAccess', openAccess, 'fas fa-lock-open');
            
            // المكتبات الرقمية
            const digitalLibraries = additionalSources.filter(source => 
                source.name.includes('Library') || source.name.includes('Archive') || 
                source.name.includes('Discovery') || source.name.includes('UCL')
            );
            displayQuickLinks('digitalLibraries', digitalLibraries, 'fas fa-book');
            
            // المجلات العلمية
            const scientificJournals = additionalSources.filter(source => 
                source.name.includes('Journal') || source.name.includes('Oxford') || 
                source.name.includes('Ahkam') || source.name.includes('ASJP') || 
                source.name.includes('AJOL')
            );
            displayQuickLinks('scientificJournals', scientificJournals, 'fas fa-newspaper');
        }

        // إنشاء بطاقة مصدر
        function createSourceCard(source) {
            const card = document.createElement('div');
            card.className = 'card resource-card';
            card.style.cssText = `
                opacity: 0;
                transform: translateY(20px);
                transition: all 0.6s ease;
            `;

            const badgeClass = source.access_type === 'مجانية' ? 'free-badge' : 'premium-badge';
            const badgeText = source.access_type === 'مجانية' ? 'مجاني' : 'مميز';

            card.innerHTML = `
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <h5 class="card-title">${source.name}</h5>
                        <span class="${badgeClass}">${badgeText}</span>
                    </div>
                    <p class="card-text text-muted">${source.description}</p>
                    <a href="${source.url}" target="_blank" class="resource-link">
                        <i class="fas fa-external-link-alt me-2"></i> زيارة الموقع
                    </a>
                </div>
            `;

            // تأثير الظهور المتأخر
            setTimeout(() => {
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 100);

            return card;
        }

        // عرض الروابط السريعة
        function displayQuickLinks(containerId, sources, iconClass) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            sources.forEach(source => {
                const linkItem = document.createElement('a');
                linkItem.href = source.url;
                linkItem.target = '_blank';
                linkItem.className = 'quick-link-item resource-link';
                linkItem.style.cssText = `
                    opacity: 0;
                    transform: translateY(10px);
                    transition: all 0.4s ease;
                `;
                
                linkItem.innerHTML = `
                    <i class="${iconClass} me-2"></i> ${source.name}
                `;
                
                container.appendChild(linkItem);
                
                // تأثير الظهور المتتابع
                setTimeout(() => {
                    linkItem.style.opacity = '1';
                    linkItem.style.transform = 'translateY(0)';
                }, sources.indexOf(source) * 100);
            });
        }

        // عرض رسالة الخطأ
        function showErrorMessage(message) {
            const openSources = document.getElementById('openSources');
            const closedSources = document.getElementById('closedSources');
            
            const errorHTML = `
                <div style="text-align: center; padding: 40px; color: var(--error-color); grid-column: 1 / -1;">
                    <i class="fas fa-exclamation-triangle fa-3x"></i>
                    <h3 style="margin: 20px 0;">${message}</h3>
                    <button onclick="loadScientificSources()" class="btn btn-primary">إعادة المحاولة</button>
                </div>
            `;
            
            openSources.innerHTML = errorHTML;
            closedSources.innerHTML = '';
        }

        // عرض رسالة عدم وجود مصادر
        function showNoSources() {
            const openSources = document.getElementById('openSources');
            const closedSources = document.getElementById('closedSources');
            
            const noDataHTML = `
                <div style="text-align: center; padding: 40px; color: var(--secondary-color); grid-column: 1 / -1;">
                    <i class="fas fa-database fa-3x" style="margin-bottom: 20px; opacity: 0.5;"></i>
                    <h3 style="color: var(--secondary-color); margin-bottom: 15px;">لا توجد مصادر علمية متاحة حالياً</h3>
                    <p>سيتم إضافة المزيد من المصادر قريباً</p>
                </div>
            `;
            
            openSources.innerHTML = noDataHTML;
            closedSources.innerHTML = '';
        }
    </script>
</body>
</html>
